# VDD、VSS
D=device 表示器件的意思, 即器件内部的工作电压；S=series 表示公共连接的意思，通常指电路公共接地端电压。

# VDD、VSS是芯片工作的电压端口，主要为IO供电以及通过稳压器为内核、内置数字外设、存储器等供电。简单来说就是为所有芯片的数字电路部分供电。

# VDDA、VSSA
A=analog 表示模拟的意思，是模拟电路部分的电源。主要为ADC模块以及其他的模拟电路部分（复位电路、PLL等）供电。

ADC使用一个独立于VDD的电源供电，过滤和屏蔽来自印刷电路板上的毛刺干扰，ADC的电源引脚为VDDA，以及独立的电源地VSSA。

即使不使用ADC功能，也需要连接VDDA，强烈建议VDD和VDDA使用同一个电源供电。比如因为连接着复位电路，如果不连，芯片无法下载代码。

# VREF+、VREF-
REF=referencee，VREF表示ADC的外部参考电压，如果有VREF- 引脚(根据封装而定)，它必须连接到VSSA，VREF+的输入范围为2.4~VDDA（一般接VDDA）。如果没有VREF+和VREF-引脚，他们在芯片内部与ADC的电源(VDDA)和地(VSSA)相连。

# VBAT
使用电池或其他电源连接到VBAT脚上，当VDD断电时，可以保存备份寄存器的内容和维持RTC的功能。
VBAT脚也为RTC、LSE振荡器和PC13至PC15供电，这保证当主要电源被切断时RTC能继续工作。切换到VBAT供电由复位模块中的掉电复位功能控制。如果应用中没有使用外部电池，VBAT必须连接到VDD引脚上。

<table border="1" cellpadding="1" cellspacing="1" style="width:580px;"><tbody><tr><td style="width:66px;">VCC</td><td style="width:182px;">电源电压</td><td style="width:63px;">GND</td><td style="width:187px;">电源供电负电压&#xff08;通常接地&#xff09;</td></tr><tr><td style="width:66px;">VDD</td><td style="width:182px;">模块工作正电压</td><td style="width:63px;">VSS</td><td style="width:187px;">模块工作负电压</td></tr><tr><td style="width:66px;">VREF&#43;</td><td style="width:182px;">ADC参考正电压</td><td style="width:63px;">VREF-</td><td style="width:187px;">ADC参考负电压</td></tr><tr><td style="width:66px;">VBAT</td><td style="width:182px;">电池或其他电源供电</td><td style="width:63px;"></td><td style="width:187px;"></td></tr><tr><td style="width:66px;">VDDA</td><td style="width:182px;">模拟供电正电压</td><td style="width:63px;">VSSA</td><td style="width:187px;">模拟供电负电压</td></tr></tbody></table> 



STM32F103系列的单片机64脚和64脚以下的都把VDDA和VREF内部连在一起，没独立开管脚。而100脚和100脚以上却是单独分开。

一般如果我们对采集精度不高，VDDA和VREF都直接接到3.3V电源VDD上，采用稳定和精度高的电源稳压IC，在电路上加滤波电路或在软件上做滤波处理，即可满足正常使用。


如果对AD精度要求高，AD供电和基准电压输入必须与MCU电源分开单独供电，REF电压基准IC可以为AD提供高度基准电压，其中REF31系列采用SOT23-3小封装，提供1.25、2.048、2.5、3.0、3.3、4.096电压输出，其中REF3133提供3.3V基准电压，0.2%精度，最大+-10ma电流输出。


最近在进行原理图设计的时候遇到了一个问题，就是STM32的100管脚一下芯片没有Vref的问题。64Pin及以下封装的芯片电源管脚有：

    VDD - 单片机3.3V 电源正，
    VSS - 单片机3.3V 电源负，
    VDDA - 单片机A/D 转换器电源正，
    VSSA - 单片机A/D 转换器电源负。

插一句：由于STM32F103系列单片机的内部高速RC 振荡器（HSI）由VDDA、VSSA 供电，故即使不使用单片机自带的A/D 转换器，也必须保证VDDA、VSSA 的供电，否则STM32F103单片机不能正常启动。

言归正传

    在小于等于64Pin的芯片中，在芯片的内部Vref+是和VDDA连接在一起的，也就是说ADC的是以VDDA为参考电压的。那么还有一点需要注意的就是VDDA和VDD的压差必须小于300mV ，否则可能由于上电断电的非同时性，导致数据的丢失。然而这就有可能导致了ADC参考电压的非精确性。

如何解决ADC参考电压的问题呢？

一、每个STM32芯片都有一个**内部**的参照电压，相当于一个标准电压测量点，在芯片内部连接到ADC1的通道17。根据数据手册中的数据，这个参照电压的典型值是1.20V，最小值是1.16V，最大值是1.24V。这个电压基本不随外部供电电压的变化而变化。

不少人把这个参照电压与ADC的参考电压混淆。ADC的参考电压都是通过Vref+提供的。100脚以上的型号，Vref+引到了片外，引脚名称为Vref+；64脚和小于64脚的型号，Vref+在芯片内部与VDDA信号线相连，没有引到片外，这样AD的参考电压就是VDDA上的电压。

如果对于ADC测量的准确性要求不高时，可以使用这个内部参照电压得到ADC测量的电压值。具体方法是在测量某个通道的电压值之前，先读出参照电压的ADC测量数值，记为ADrefint；再读出要测量通道的ADC转换数值，记为ADchx；则要测量的电压为：

    Vchx = Vrefint * (ADchx/ADrefint)。其中Vrefint为参照电压=1.20V。

二、选用外部参考基准电压，其原理同第一种是一样一样的，只不过将第一种中的参照电压换成了自己设定的基准源的电压，公式同上。



# 启动模式

1）主FLASH = 芯片内置的Flash。
2）SRAM = 芯片内置的RAM区，就是内存啦。
3）系统存储器 = 芯片内部一块特定的区域，芯片出厂时在这个区域预置了一段Bootloader，就是通常说的ISP程序。这个区域的内容在芯片出厂后没有人能够修改或擦除，即它是一个ROM区。这个系统存储器只是帮你通过ISP程序下载hex进去的

## 从主FLASH启动
其中用于FLASH的地址范围为0x0800 0000~0x080F FFFF ，大小为1MB

将主Flash地址0x08000000映射到0x00000000，这样代码启动之后就相当于从0x08000000开始。主闪存存储器是STM32内置的Flash，作为芯片内置的Flash，是正常的工作模式。一般我们使用JTAG或者SWD模式下载程序时，就是下载到这个里面，重启后也直接从这启动程序。

## 从系统存储区启动
系统存储区地址范围为0x1FFF 0000~0x1FFF 7A0F，大小为30KB

系统存储区实际上存放了一段ST事先写好的BootLoader程序，且不可以被修改，用于ISP下载，也就是串口方式下载，当我们将BOOT0拉高，BOOT1拉低时，也就是系统存储器模式启动，单片机会将0x1FFF 0000~0x1FFF 7A0F这段空间映射到0x0000 0000处，运行系统内置的BootLoader程序，也就是串口下载的程序，使用串口将程序下载到FLASH中，下载完成之后就将BOOT0拉低，重启，使用主FLASH的方式运行使用串口下载的程序了。

## 从SRAM启动
SRAM位于block2 地址范围从0x2000 0000开始，不同型号大小不同

将SRAM地址0x20000000映射到0x00000000,这样代码启动之后就相当于从0x20000000开始。内置SRAM，也就是STM32的内存，既然是SRAM，自然也就没有程序存储的能力了，这个模式一般用于程序调试。假如我只修改了代码中一个小小的地方，然后就需要重新擦除整个Flash，比较的费时，可以考虑从这个模式启动代码，用于快速的程序调试，等程序调试完成后，在将程序下载到SRAM中。
